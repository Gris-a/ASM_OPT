# Hash-table optimization

## About

В данном проекте была реализована хеш-таблица методом цепочек в целях тестирования различных хеш-функций и изучения ассемблерных оптимизаций.

Хеш-таблица была основана на том, что коллизии были разрешены путём объединения элементов с одим значением хеша в список. Чтобы вставить новый элемент в таблицу, нужно посчитать его хеш и затем пройтись по цепочке, попутно сравнивая все элементы списка с нашим, что может быть долго, поэтому нашей целью является получить хеш-функцию, дающую наименьшее число коллизий, то есть наиболее равномерное распределение, для анализа которого просчитывалась дисперсия случайной величины ξ - длины цепочки $D[ξ] = Ε[ξ^2] - Ε[ξ]^2$, где математические ожидания $E[ξ]$ и $Ε[ξ^2]$ считаются как средние арифметические ввиду предположения о равновероятности попадания в любую клетку хеш-таблицы.

Для тестирования были выбраны следующие хеш-функции:

- ConstHash    - константный 0
- CharHash     - первый символ строки
- StrLenHash   - длина строки
- CheckSumHash - контрольная сумма(сумма всех ASCII-кодов символов строки)
- RotL         - подсчёт хеша за счёт битового поворота влево
- RotR         - подсчёт хеша за счёт битового поворота вправо
- CRC32        - подсчёт циклического избыточного кода

Хеш-функции тестировались на наборе [hash_functions_test](hash_functions_testing/data/hash_functions_test.txt), затем строились графики зависимости длины цепочки от её номера в таблице и проводился анализ. Для анализа размер таблицы брался примерно в 3 раза меньше размера данных. Далее была выбрана лучшая из полученных хеш-функций и хеш-таблица была оптимизирована на уровне ассемблера.

## Instalation and testing

Установка:

    git clone https://github.com/Gris-a/ASM_OPT.git
    cd ASM_OPT
    cd hash_functions_testing && make
    cd ../
    cd hash_table_optimizations && make

Запуск тестирования:

    .hash_functions_testing/scripts/runtests.bash
    .hash_table_optimizations/scripts/runtests.bash

После завершения программы результаты тестирования хеш-функций появятся в папке [results](/hash_functions_testing/data/results), результаты профилирования разных этапов оптимизации хеш-таблицы появятся в папке [prof_results](/hash_table_optimizations/data/prof_results). Поледние могут быть визуализированы при помощи `Kcachegrind`.

## Testing

Далее будут подробно описаны используемые хеш-функции и анализ результатов их тестирования.

### ConstHash

```C
size_t HashFuncConst(char *key, size_t mod)
{
    return 0;
}

```

При таком подходе становится очевидно, что таблица превращается в односвязный список, сводя на нет все преимущества хеширования, что подтверждают графики:
|                                 |                                 |
|:-------------------------------:|:-------------------------------:|
|![](/readme_assets/ConstHash.png)|![](/readme_assets/1ConstHash.png)|

и полученная дисперсия $D = $.